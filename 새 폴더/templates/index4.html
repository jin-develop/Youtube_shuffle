<!doctype html>
<html lang="en">

<head>

  <!-- Webpage Title -->
  <title>왜안대ㅐㅐㅐㅐㅐ</title>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" href="favicon.ico" type="image/x-icon">

  <!-- CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <!-- JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
  <!-- 
  <meta property="og:url" content="http://findmyinterior.shop/">
  <meta property="og:title" content=" 여러가구 한눈에 보기 ">
  <meta name="og:description" content=" 가구찾기 --------첫홈페이지 JH~~~~~~~~~~~~~~~~~ ">
  <meta property="og:image" content="https://i.pinimg.com/originals/a2/56/b1/a256b1a325a6af0f2f76c48180f9193a.jpg"> -->



  <script type="text/javascript">
 
    function goTorandom() {
      window.location.href = '/rand';
    }

    function okgood() {
      alert(textHtml)
      alert("!!s")

    }
    // function close() {
    //   var new_popup =  window.open('http://www.daum.net ', '_blank');
    //   new_popup.close();
    // }





    // 셔플하기 
    Array.prototype.shuffle = function () {
      var length = this.length;

      // 아래에서 length 후위 감소 연산자를 사용하면서 결국 0이된다.
      // 프로그래밍에서 0은 false를 의미하기에 0이되면 종료.
      while (length) {
        // 랜덤한 배열 index 추출
        var index = Math.floor((length--) * Math.random());
        // 배열의 끝에서부터 0번째 아이템을 순차적으로 대입
        var temp = this[length];
        // 랜덤한 위치의 값을 맨뒤(this[length])부터 셋팅
        this[length] = this[index];
        // 랜덤한 위치에 위에 설정한 temp값 셋팅
        this[index] = temp;
      }// 배열을 리턴해준다.
      return this;
    };
    //



    // 시간 계산해주는 함수 만들기
    function check_time() {
      const links = document.getElementsByTagName('a');
      var new_hrefs = [];
      for (var i =1; i < links.length; i++) {
        new_hrefs.push(links[i].href);
      }
      console.log(new_hrefs);
      var hrefs = [];
      $.each(new_hrefs,function(i,value){
    if(hrefs.indexOf(value) == -1 ) hrefs.push(value);
});

console.log(hrefs);



      start_times = [];
      // 몇초에 시작하는지 알아보는 반복문!
      for (let i = 0; i < hrefs.length; i++) {
        var sksnrl = hrefs[i];
        var sms = sksnrl.split("=");
        var times = sms.pop();
        var start_time = times.replace(/[a-z]/gi, "");
        // console.log(start_time)
        // console.log(typeof start_time)
        start_times.push(start_time);
      }
      console.log(start_times);
      //


      // 사이에 있는 시간 구하기.
      var intervals = [];
      for (let i = 0; i < start_times.length; i++) {
        if (i  == start_times.length - 1) {
          interval = 200;
          intervals.push(interval + 2)
          break;
        }
        var interval = start_times[i + 1] - start_times[i]
        intervals.push(interval + 2)
      }
        console.log(intervals);



      var test_dicts = {};
     var test_arrays = [];
      for (let index = 0; index < hrefs.length; index++) {
        
        console.log(hrefs[index]);
        console.log(intervals[index]);
        var one_key = hrefs[index];
        var one_value = intervals[index];
        test_dicts['url'] = one_key;
        test_dicts['sec'] = one_value;
        test_arrays.push(test_dicts);
        var test_dicts = {};
        continue;
        console.log(test_dicts)
        console.log(test_arrays)
      }
      console.log(test_arrays)

      var time_dict = {};
      var gogo_test = [];
      const start_times_key = [];
      for (let j = 0; j < hrefs.length; j++) {
        time_dict[hrefs[j]] = intervals[j]
      }
      console.log(time_dict)
      intervals = intervals.filter(function (a) {
           var key = Object.keys(a).map(function (k) { return a[k]; }).join('|');
           if (!this[key]) {
               return this[key] = true;
           }
       }, Object.create(null));

      return test_arrays;
    }

    // 위 함수와 연결하기
    function get_data_and_open3(time_dict) {

      var get_hrefs = check_time(time_dict);
      console.log("*" * 40);
      console.log(get_hrefs)
      var get_keys = Object.keys(get_hrefs);
      console.log(get_keys);


      array_test.shuffle();
      console.log(array_test);

      var times = [];
      // 반복문을 통해 
      for (let index = 0; index < array_test.length; index++) {
        console.log(array_test[index][0]);
        console.log(array_test[index][1]);
        times.push(array_test[index][1]);
        console.log(typeof array_test[index][1])
        console.log('next')

        console.log(index)
      }

    console.log(times);

      // 중복제거 기능도 넣어야한다.

    }


function get_data_and_open(test_arrays){ (function () {
   
    var test_arrays = check_time(test_arrays);
    var test_array = test_arrays.shuffle();
  console.log(test_array)

    // Return random number from 0 to max - 1
    function getRandomIdx(max) {
        return Math.floor(Math.random() * max);
    }

    // Next idx form array
    function getNextIdx(idx, length) {
        console.log(idx);
        return (idx + 1)  % length;
    }

    // Play video (mock)
    function playVideo(url) {
        console.log('Play:', url);
        var popOption = "scrollbars=no,width=900,height=500,status=no,menubar=no,location=no,toolbar=no"
        // objPopup = window.open(url, "Example", popOption);
    }


    idx = getRandomIdx(test_array.length),
    nextIdx = getNextIdx(idx, test_array.length);

    playVideo(test_array[idx].url);

    (function playLoop() {
        setTimeout(function() {
            playVideo(test_array[nextIdx].url);

            idx = nextIdx;
            nextIdx = getNextIdx(idx, test_array.length);
            
            playLoop();
        }, test_array[idx].sec * 1000);    
    })();
})();
}

function close123()
{

  if (objPopup != undefined)
{
  objPopup.close();
location.reload(true);
}
}



  </script>


  <!-- style -->
  <style type="text/css">
    .some {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 10px;
      margin: 5px;
    }

    #btn_group button {
      border: 1px solid skyblue;
      background-color: rgba(8, 142, 252, 0);
      color: rgb(44, 168, 218);
      padding: 5px;
    }

    #go1 {
      margin: 10px;
    }

    #go2 {
        margin:auto;
      margin: 20px;
      width: 200px;
      height: 50px;
    }
    body {
        margin: 0 auto;
        width: 480px;
    }
    #gobutton {
        margin: 0 auto;
        width: 360px;
    }
  </style>


</head>







<body >




  <h1><br>
    &nbsp; &nbsp; &nbsp; &nbsp;

    Shuffle list <br><br>

  </h1>
  <h2> <a href="http://www.naver.com/" target="_sub">사용법 | How to use</a></h2>
  유튜브 광고로 인하여 프리미엄 사용자들에게 권합니다.<br>
  <br>
  <div>
    <div id='textHtml2' name="textHtml2" style='width:400px;height:200px;border:solid 1px gray;overflow-y: auto;'
      contentEditable='true'>
      Input contents </div> 
      
  </div>
<div id="gobutton">
 
 <button type="button" class="btn btn-success"  id="go2" onclick="get_data_and_open();" >go to the shuffle</button>
 
 <button type="button" class="btn btn-warning"  id="go2" onclick="close123();">close and refresh</button>
</div>
<!-- <button name="forwardBtn" id="go2" onclick="get_data_and_open();">go shuffle</button><br>
<button name="forwardBtn" id="go2" onclick="close123();">close</button> -->
</body>

</html>